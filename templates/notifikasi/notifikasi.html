<style>
  /* CSS khusus untuk komponen notifikasi */
  #notification-dropdown {
    transition: opacity 0.2s ease-out, transform 0.2s ease-out;
  }
  .notification-item:not(:last-child) {
    border-bottom: 1px solid #e5e7eb;
  }
  .notification-item.unread {
    background-color: #eff6ff;
  }
  .notification-item.unread:hover {
    background-color: #dbeafe;
  }
  #notification-list::-webkit-scrollbar {
    width: 6px;
  }
  #notification-list::-webkit-scrollbar-track {
    background: #f1f5f9;
  }
  #notification-list::-webkit-scrollbar-thumb {
    background: #94a3b8;
    border-radius: 3px;
  }
  #notification-list::-webkit-scrollbar-thumb:hover {
    background: #64748b;
  }
</style>

<div class="relative">
  <button id="notification-button" class="relative text-gray-500 hover:text-gray-700 focus:outline-none">
    <i class="fas fa-bell text-xl"></i>
    {% if urgent_requests|length > 0 %}
    <span class="absolute -top-1 -right-1 flex h-5 w-5">
      <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span>
      <span class="relative inline-flex rounded-full h-5 w-5 bg-red-500 text-white text-xs items-center justify-center">{{ urgent_requests|length }}</span>
    </span>
    {% endif %}
  </button>
  <div id="notification-dropdown" class="absolute right-0 mt-2 w-80 sm:w-96 bg-white rounded-md shadow-lg z-50 hidden ring-1 ring-black ring-opacity-5" style="transform-origin: top right">
    <div class="px-4 py-3 border-b">
      <p class="text-sm font-semibold text-gray-900">Notifikasi Permintaan Urgensi</p>
    </div>
    <div id="notification-list" class="max-h-96 overflow-y-auto">
      {% if urgent_requests %} {% for req in urgent_requests %}
      <a href="{{ url_for('mws_detail', part_id=req.part_id) }}" class="notification-item block px-4 py-3 hover:bg-gray-100 unread">
        <div class="flex items-start">
          <div class="flex-shrink-0 h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center mr-3">
            <i class="fas fa-exclamation-triangle text-blue-500"></i>
          </div>
          <div class="flex-1">
            <p class="text-sm text-gray-800">Permintaan urgensi untuk <strong>{{ req.partNumber }}</strong></p>
            <p class="text-xs text-gray-500 mt-1">Oleh: {% if req.assignedTo and req.assignedTo in users %}{{ users[req.assignedTo].name }}{% else %}N/A{% endif %}</p>
            <p class="text-xs text-gray-400 mt-1">{{ req.targetDate }}</p>
          </div>
        </div>
      </a>
      {% endfor %} {% else %}
      <div class="text-center py-10 px-4">
        <i class="fas fa-check-circle text-gray-300 text-4xl mb-2"></i>
        <p class="text-sm text-gray-500">Tidak ada notifikasi baru.</p>
      </div>
      {% endif %}
    </div>
    <div class="border-t">
      <a href="#" class="block text-center px-4 py-2 text-sm text-blue-600 hover:bg-gray-50">Lihat Semua</a>
    </div>
  </div>
</div>
